<!DOCTYPE html>
<html>
<head>
    <title>Check Airtable Tables</title>
    <script src="env-config.js"></script>
    <script src="config-loader.js"></script>
    <script src="config.js"></script>
</head>
<body>
    <h1>Airtable Tables in Base</h1>
    <div id="result"></div>

    <script>
        async function checkTables() {
            const API_KEY = typeof AIRTABLE_CONFIG !== 'undefined' ? AIRTABLE_CONFIG.API_KEY : 'YOUR_API_KEY';
            const BASE_ID = typeof AIRTABLE_CONFIG !== 'undefined' ? AIRTABLE_CONFIG.BASE_ID : 'appZcPs57spwdoKQH';

            try {
                // Airtable Metadata API를 사용하여 Base 정보 가져오기
                const response = await fetch(`https://api.airtable.com/v0/meta/bases/${BASE_ID}/tables`, {
                    headers: {
                        'Authorization': `Bearer ${API_KEY}`
                    }
                });

                if (response.ok) {
                    const data = await response.json();
                    let html = '<h2>Tables found:</h2><ul>';

                    data.tables.forEach(table => {
                        html += `<li><strong>${table.name}</strong>: ${table.id}</li>`;
                        if (table.name === 'Administrators' || table.name.toLowerCase().includes('admin')) {
                            html += `<p style="color: green;">⬆️ This looks like the Administrators table!</p>`;
                        }
                    });

                    html += '</ul>';
                    document.getElementById('result').innerHTML = html;
                } else {
                    // Metadata API가 없을 수 있으므로 알려진 테이블 시도
                    document.getElementById('result').innerHTML = `
                        <p>Metadata API not available. Please check manually in Airtable.</p>
                        <p>Known tables in this base:</p>
                        <ul>
                            <li>CLT Participants: tblxMzwX1wWJKIOhY</li>
                            <li>Administrators: (need to check in Airtable)</li>
                        </ul>
                        <p>To find Administrators table ID:</p>
                        <ol>
                            <li>Go to https://airtable.com</li>
                            <li>Open base: appZcPs57spwdoKQH</li>
                            <li>Click on "Administrators" table</li>
                            <li>Copy the table ID from URL (starts with tbl)</li>
                        </ol>
                    `;
                }
            } catch (error) {
                document.getElementById('result').innerHTML = `
                    <p>Error: ${error.message}</p>
                    <p>Please check the table ID manually in Airtable web interface.</p>
                `;
            }
        }

        checkTables();
    </script>
</body>
</html>